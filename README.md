
# Q-CAD Model: Test Run and Training Guide

## Overview

This project implements the **Quantized Convolutional Accelerated Detection (Q-CAD)** model, aimed at detecting Distributed Denial of Service (DDoS) attacks. It utilizes quantization techniques to reduce inference latency and memory consumption, enabling real-time detection on edge devices.

### Key Features
- Uses **Ternary Neural Networks (TNN)**, **Ternary-Binary Networks (TBN)**, and **Binary Neural Networks (BNN)** for quantization.
- **Channel Concatenation-Based Quantized Inference (CCQI)** method for optimized convolution operations.
- Preprocessed datasets using the **ATSPA** method for efficient DDoS detection.
  
---

## Test Run Guide

To run tests on the Q-CAD model, use the following command:

```bash
make run MAIN=<test>.c
```

Where `<test>` corresponds to:
- `test_qcad`: Measures inference time for the **QCAD** model.
- `test_qcads`: Measures inference time for the **QCADs** model.
- `test_qcadm`: Measures inference time for the **QCADm** model.
- `tesetcase_bnn`: Executes a test case generated by `gen_testcase.ipynb` to determine the accuracy of the **BNN** model. Similar commands can be used for **TBN** and **TNN** tests.

---

## Training and Data Preprocessing

### Model Training
To train the Q-CAD model, execute the commands provided in the `train.ipynb` notebook. For those who prefer using pre-trained models, you can download them from the following link:
[Pre-trained Q-CAD Model](https://drive.google.com/drive/folders/1CV8OykI0Xo0sjkSSTk_Z2LQRtQhyE8ui?usp=sharing).

### Data Preprocessing
The datasets used for training are preprocessed using the **ATSPA** method. You can generate the datasets using the following notebooks:
- `bot_iot.ipynb`: Preprocesses the **BoT-IoT** dataset.
- `cic2017.ipynb`: Preprocesses the **CIC-DDoS2017** dataset.

For convenience, preprocessed datasets are available at:
[Preprocessed Datasets](https://drive.google.com/drive/folders/1jvv_SrJi5V3Bv6t-WdJxV56DpatJeglv?usp=sharing).

---

## Model Variants

### Q-CAD Variants
The Q-CAD model is provided in three quantized variants:
- **TNN**: Ternary Neural Network, providing a balanced trade-off between accuracy and speed.
- **TBN**: Ternary-Binary Network, offering slightly faster computation with a minor accuracy trade-off.
- **BNN**: Binary Neural Network, optimized for speed but with a noticeable accuracy reduction.

### Evaluation Datasets
- **BoT-IoT Dataset**: Provides a wide variety of attack types such as DDoS and network reconnaissance.
- **CIC-DDoS2017 Dataset**: Focuses on modern DDoS attack types, including UDP, TCP, and HTTP attacks.

---

## Inference Time and Performance

The Q-CAD model has been tested on three different hardware platforms:
1. **ESP32-C3**: 32-bit RISC-V processor.
2. **BKRouter**: Custom router platform with ARMv7 architecture.
3. **Intel Core i5 9400f**: Desktop-grade processor for high-performance testing.

Experiments show that quantized models achieve up to **40x speedup** compared to the non-quantized versions, making the Q-CAD model highly suitable for real-time deployment.

For detailed evaluation metrics such as accuracy, F1-score, and false positive rate, refer to the experimental results in the research paper.


---

## Source Code

The source code for this project is available at the following GitHub repository:
[Q-CAD via Channel Concatenation-Based Quantized Inference for Faster DDoS Attack Detection](https://github.com/haiphu1314/-QCAD-via-Channel-Concatenation-Based-Quantized-Inference-for-Faster-DDoS-Attack-Detection.git)
